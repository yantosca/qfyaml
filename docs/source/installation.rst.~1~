.. _Installation:

############################
Installation and compilation
############################

.. _Downloading:

******************
Downloading qfyaml
******************

Use Git to clone this repository to your disk space:

.. code-block:: console

   $ git clone https://github.com/yantosca/qfyaml.git

This will create a folder named :file:`qfyaml` in your disk space.
   
The main :program:`qfyaml` source code is contained in the :file:`qfyaml/src`
folder.  Several test programs are included in the :file:`qfyaml/test`

.. _Configuring:

******************
Configuring qfyaml
******************

You may nowcall CMake, which will begin the configuration
process.  During the configuration step, CMake will make sure that you
have everything on your system that is required to compile the
:program:`qfyaml` source code, or else it will halt with an error.

Navigate to the :file:`qfyaml/bin` folder:

.. code-block:: console

   $ cd qfyaml/bin

and call CMake with this command:

.. code-block:: console

   $ cmake .. -B ../build

You should see output similar to this:

.. code-block:: console

   -- The Fortran compiler identification is GNU 11.1.0
   -- Detecting Fortran compiler ABI info
   -- Detecting Fortran compiler ABI info - done
   -- Check for working Fortran compiler: /bin/gfortran - skipped
   -- Configuring done
   -- Generating done
   -- Build files have been written to: /home/bob/work/qfyaml/build

.. _Compiling:
   
***************
Compling qfyaml
***************

During the configuration step, CMake creates the Makefiles that will
be used to compile the :program:`qfyaml` source code into library
files and executables.  Once the configuration step has completed
successfully, you may proceed to compile the source code.

Type the following at the command line:

.. code-block::

   make -C ../build

The :file:`-C` command tells :program:`make` to look in the
:file:`../build` folder for the Makefiles that were created by CMake.
These Makefiles will direct the build process.

.. _Installing:

*****************
Installing qfyaml
*****************

Once compilation has finished successfully, we may install the
compiled code (and various input files)  to the :file:`qfyaml/bin`
folder.

Type at the command line:

.. code-block:: console

   make -C ../build install

Then to see the files that were installed, type:

.. code-block:: console

   cd ../bin
   ls -1

and you should see this directory listing:

.. code-block:: console

   geoschem_config.yml
   input.yml
   species_database_apm.yml
   species_database_tomas.yml
   species_database.yml
   test_geoschem_config.x
   test_qfyaml.x
   test_species_database.x

Executable files for the various tests (which are discussed in the
next chapter) end with the :file:`.x` extension.  The corresponding
configuration files in YAML format end with the :file:`.yml` format.



